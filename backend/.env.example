# Brain (OpenAI-compatible) for text rewrite (洗稿)
BRAIN_API_KEY=sk-xxx
BRAIN_BASE_URL=http://127.0.0.1:4000/v1
BRAIN_MODEL=gemini-3-pro

# Optional: matting sidecar
MATTING_BASE_URL=http://127.0.0.1:8911

# XHS crawler (Playwright persistent profile)
# XHS_USER_DATA_DIR is required for stable one-time login reuse.
XHS_USER_DATA_DIR=/Users/yourname/.xhs-playwright-profile
XHS_PLAYWRIGHT_HEADLESS=false
XHS_CRAWL_TIMEOUT=60

# Auto login within the same /xhs/extract request (recommended)
XHS_AUTO_LOGIN_ON_401=true
XHS_AUTO_LOGIN_WAIT_MS=120000
XHS_AUTO_LOGIN_POLL_INTERVAL_MS=1000

# Persist exported cookies to backend/.env (so /xhs/image can use it immediately)
XHS_COOKIE_PERSIST_TO_ENV=true
# XHS_COOKIE_ENV_PATH=/absolute/path/to/backend/.env
XHS_COOKIE_PERSIST_MIN_INTERVAL_S=60

# AB images (配图仿写)
# 并发度（图片数 * levels 会并发跑，但外部 Painter 可能会限流；建议 2~4 之间试）
# AB_IMAGES_CONCURRENCY=2
#
# V2 mask-edit：保护产品但允许重绘原图阴影/倒影
# 产品核心阈值（越大越“只保护产品本体”，更容易去掉原图阴影/倒影）
# AB_PRODUCT_CORE_THRESHOLD=224
#
# 先做一次开运算（腐蚀+膨胀）去掉“阴影突起”等噪声（像素）
# AB_PRODUCT_MASK_OPEN_PX=3
#
# 保护边缘膨胀（越大越不容易动到产品边缘，但也更容易残留原图阴影/倒影）
# AB_MASK_PROTECT_DILATE_PX=4
#
# 细节保真：只在产品核心区做高频细节迁移，避免把原图阴影/倒影带回去
# AB_DETAIL_TRANSFER_THRESHOLD=224
# AB_DETAIL_TRANSFER_INNER_ERODE_PX=8
